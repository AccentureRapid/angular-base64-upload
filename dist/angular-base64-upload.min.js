/*! angular-base64-upload - v0.1.0
* https://github.com/adonespitogo/angular-base64-upload
* Copyright (c) Adones Pitogo <pitogo.adones@gmail.com> 2015;
* Licensed MIT */
!function(a){"use strict";function b(b){for(var c="",d=new Uint8Array(b),e=d.byteLength,f=0;e>f;f++)c+=String.fromCharCode(d[f]);return a.btoa(c)}var c=a.angular;c.module("naif.base64",[]).directive("baseSixtyFourInput",["$rootScope",function(d){return{restrict:"A",require:"ngModel",link:function(e,f,g,h){function i(){e.$apply(function(){var a=g.multiple?p:p[0]||[];h.$setViewValue(c.copy(a))})}function j(a){var c=b(a.target.result);q.base64=c,p.push(q),r++,r<o.length?n():i()}function k(a){return function(b){d.$broadcast("base64:event:"+a,b,o,p,o[r])}}function l(a,b){e.$apply(function(){h.$setValidity(a,b)})}function m(){h.$validate();for(var a=o.length-1;a>=0;a--){var b=o[a];if(g.maxsize&&b.size>1e3*parseFloat(g.maxsize))return void l("maxsize",!1);if(g.minsize&&b.size<1e3*parseFloat(g.minsize))return void l("minsize",!1)}n()}function n(){var a=o[r];q={},q.filetype=a.type,q.filename=a.name,q.filesize=a.size,s.readAsArrayBuffer(a)}var o=[],p=[],q={},r=0,s=new a.FileReader;s.onabort=k("onabort"),s.onerror=k("onerror"),s.onloadstart=k("onloadstart"),s.onloadend=k("onloadend"),s.onprogress=k("onprogress"),s.onload=j,h.$validators.required=function(a,b){var c=a||b||[];return c.hasOwnProperty("length")?c.length>0:c?!0:!1},h.$validators.maxnum=function(){return g.maxnum&&o.length>parseInt(g.maxnum)?!1:!0},h.$validators.minnum=function(){return g.minnum&&o.length<parseInt(g.minnum)?!1:!0},f.on("change",function(){f[0].files.length&&(o=f[0].files,p=[],r=0,l("maxsize",!0),l("minsize",!0),l("maxnum",!0),l("minnum",!0),l("required",!1),m())})}}}])}(this);