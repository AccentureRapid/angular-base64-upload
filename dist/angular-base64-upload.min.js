/*! angular-base64-upload - v0.1.0
* https://github.com/adonespitogo/angular-base64-upload
* Copyright (c) Adones Pitogo <pitogo.adones@gmail.com> 2015;
* Licensed MIT */
!function(a){"use strict";function b(b){for(var c="",d=new Uint8Array(b),e=d.byteLength,f=0;e>f;f++)c+=String.fromCharCode(d[f]);return a.btoa(c)}var c=a.angular;c.module("naif.base64",[]).directive("baseSixtyFourInput",["$rootScope",function(d){return{restrict:"A",require:"ngModel",link:function(e,f,g,h){function i(){e.$apply(function(){var a=g.multiple?q:q[0]||[];h.$setViewValue(c.copy(a))})}function j(a){var c=b(a.target.result);r.base64=c,q.push(r),s++,s<p.length?m():i()}function k(a){return function(b){d.$broadcast("base64:event:"+a,b,p,q,p[s])}}function l(){m()}function m(){var a=p[s];r={},r.filetype=a.type,r.filename=a.name,r.filesize=a.size,t.readAsArrayBuffer(a)}function n(a,b){e.$apply(function(){h.$setValidity(a,b)})}function o(){for(var a=p.length-1;a>=0;a--){var b=p[a];if(g.maxsize&&b.size>1e3*parseFloat(g.maxsize))return void n("maxsize",!1);if(g.minsize&&b.size<1e3*parseFloat(g.minsize))return void n("minsize",!1)}l()}var p=[],q=[],r={},s=0,t=new a.FileReader;t.onabort=k("onabort"),t.onerror=k("onerror"),t.onloadstart=k("onloadstart"),t.onloadend=k("onloadend"),t.onprogress=k("onprogress"),t.onload=j,f.on("change",function(){f[0].files.length&&(p=f[0].files,q=[],s=0,n("maxsize",!0),n("minsize",!0),n("maxnum",!0),n("minnum",!0),n("required",!1),o())}),h.$validators.required=function(a,b){var c=a||b||[];return c.hasOwnProperty("length")?c.length>0:c?!0:!1},h.$validators.maxnum=function(){return g.maxnum&&p.length>parseInt(g.maxnum)?!1:!0},h.$validators.minnum=function(){return g.minnum&&p.length<parseInt(g.minnum)?!1:!0}}}}])}(this);